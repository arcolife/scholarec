thap039
a studi of a realtim oper system on the intelbas vme control
t ohata and t masuda spring8 hyogo 6795198 japan
abstract
we test the realtim characterist of varieti of
vmebas cpu board and oper system to select
the next gener control for the spring8 control
previous we had use the hp9000743rt but hewlettpackard discontinu the model and no longer support it
we chose a vmebas intelarchitectur ia32 cpu
board and solari 7 as the next platform after
measur of realtim perform the interrupt
respons time the data transfer speed and the context
switch time were measur as a guid of realtim
perform the ia32 platform oper with the
solari show good enough perform for our control
system in thi paper we report on the realtim
characterist of the oper system hprt solari
and standard linux as the compar studi
1 introduct
the control system in spring8 a third gener light
sourc facil is design on networkdistribut system
1 we use hp9000743rt parisc pa7100lc
64mhz cpu board with hprt version 221 realtim
oper system as vme devic control the hprt
is base on lynxo 2 becaus hewlettpackard
announc that the suppli and support for it would be
discontinu we had to replac the cpu board we
explor the next come control and oper
system from nonproprietari system
first we select the cpu architectur from a nonproprietari philosophi we chose the ia32 system today
it is possibl to obtain perform and stabil for the
maker
product
cpu
clockmhz
memorymb
bu
1
2 test environ
we test the varieti of ia32 platform as shown in
tabl 1 all of the ia32 cpu board build on the socal pcat architectur a de facto standard pcivmebu bridg tundra universeii is embed on
these cpu board except pcisys56a which ha
anoth bridg made by advanet inc a bridg convert
the differ endian for adapt pcibu and vmebu
there is some danger that thi might endang
perform of the system
the digit io dio board wa use for the
measur of the interrupt respons time when an
interrupt came from vmebu also the sram board wa
use to measur the data transfer speed with the data size
d8 d16 and d32
tabl 1 specif of the platform on the perform measur
hewlettpackard gm 1
xycom 2
advanet 3
743rt
v155
xvme658
advme8001
pa7100lc
pentium mmx
k62
pentiumiii
64
166
333
600
16
128
64
128
vme
vme
vme
vme
gener micro system inc wwwgeneralmicrosystemscom
xycom autom inc wwwxycomcom
3
gespac wwwgespaccom
4
advanet inc wwwadvanetcojp
2
realtim control system on the ia32 platform it ha
grown up to be a reliabl system for larg control system
second we had to select the bu architectur we
decid to keep the vmebas architectur in order to
match the larg amount of current use vmebas io
system
third we investig the oper system for the
control in spring8 control the compat with
unix function call is highli import for the port of
the current control system after studi the realtim
featur we chose solari 7 as the first prioriti and linux
as a substitut os solari 7 ha some schedul class
such as timeshar ts class to keep compat with
standard unix and realtim rt class for realtim
applic 3
gespac 4
pcisys56a
pentium mmx
200
64
compactpci
the perform of the system such as realtim
characterist are essenti we measur a part of the
rhealston benchmark 4 of the system by compar
hp743rt with ia32 platform from the point of 1
interrupt respons time 2 data transfer speed tofrom
vmebu and 3 context switch time
the interrupt respons time and the data transfer speed
were measur in the kernel space by use a devic
driver which we develop the hp743rt v155 and the
pcisys56a were test for the comparison of cpu and
bu architectur depend solari 7 with tsclass wa
use to measur these perform on ia32 system
we measur the context switch time in the user
space solari 7 with rtclass and standard linux 229
were test on the ia32 system we can fix the prioriti
of the process for the realtim schedul on the rtclass
which satisfi the requir of realtim applic
hprt wa also test for the comparison of the realtim
perform
we use three kind of clock refer to measur the
process time one is the gettimeofday standard
system call it ha a microsecond resolut but it
depend on the os implement the second is the
interv timer 82c54 of the south bridg on the ia32
cpu board it count 1193180mhz clock and ha
enough time resolut for compar between ia32
system and the third is the 100mhz timer board on the
vmebu which is use for comparison between the
hp743rt and ia32 system
31 interrupt respons time
the interrupt respons time mean the delay time
between an interrupt event on the hardwar and the start
up of the interrupt servic routin of the devic driver
thi valu includ all sourc of latenc hardwar
processor dispatch lowlevel interrupt handl and
kernel thread dispatch the interrupt respons time
deadtim of the system influenc the process
perform to make the quick respons from interrupt
signalonli interrupt type wa use 56 in hprt
tabl 2 show the interrupt respons time with cpu
and bu architectur depend ia32 system are about
510 faster than hp743rt despit use the pcitabl 2 interrupt respons time with cpu and bu
architectur depend
platform
interrupt respons time msec
hp743rthprt
167
v155solari 7
159
pcisys56asolari 7
153
vmebu bridg thi appear to show that the interrupt
respons time mostli depend on the cpu clock speed
32 data transfer speed
the data transfer speed mean the effect throughput
between the main memori of the cpu and the memori on
the vme board we onli measur program io
mode without dma mode in the test the perform
of the busbridg contribut to the data transfer speed
we measur the address space depend of memori
on the vmebu we disabl a postedwrit mode of the
tundra universeii 7 to measur net throughput
between memori data set of d8 d16 and d32 were
read and written fromto vmebu at a16 a24 and a32
address space to examin the address space depend
and the data size depend there is no address space
depend figur 1 show the measur data of the
data transfer speed the hp743rt is about 30 faster
than the ia32 system in ani case the typic valu of the
measur is 12 mbytessec at d8 on the hp743rt
125
read
read
read
write
write
write
100
data transfer speed arbitrari unit
3 measur
d8
d16
d32
d8
d16
d32
075
050
025
000
743rt
v155
pcisys56a
platform
figur 1 platform depend of the data transfer speed
with relat to the memori space and the access data
size it normal to hp9000743rt to 1
33 context switch time
an os must provid a bound respons time for realtim applic context switch time is the overhead
when the kernel schedul a process to execut we
measur the context switch time to estim the
guarante maximum respons time of the system
tabl 3 show the context switch time of five
platform two kind of measur were carri out
to examin system depend on cpu load the first
two user process were run to measur the switch
time without ani unnecessari load in the singl user mode
next anoth applic with a high cpu load wa
run in the background rtclass is use for the
measur in solari 7 the result depend on not onli
the cpu perform but also the schedul overhead of
os in comparison of the result between xycom658 and
advme8001 a differ depend on the process
perform of the cpu the measur valu of the
hp743rt is consist with the data of the technic
datasheet from hewlettpackard 8 linux show the
best perform without ani load but it goe down
under the cpu load becaus the standard linux cannot
assign a fix prioriti to the process
the preemptiv kernel solari 7 wa slow thi delay
might come from preemption becaus solari 7 can
assign the fix prioriti to the process dynam the
context switch time doe not depend on the cpu load
tabl 3 context switch time with platform
depend and correl with cpu load
context switch time
sec
hp743rthprt
no load 1943 sd499
cpu load 1930 sd235
xycom658solairs7
no load 2535 sd1653
rtclass
cpu load 2506 sd1757
advme8001solaris7
no load
907 sd553
rtclass
cpu load 903 sd586
xycom658linux
no load
585 sd767
229
cpu load
10050
sd16030
advme8001linux
no load
219 sd158
229
cpu load 7020 sd1204
4 conclus
we measur the interrupt respons time data transfer
speed and the context switch time as realtim
perform the data transfer speed on the ia32 system
is a littl slower than the hp743rt system howev it is
toler in our system the decreas of the data
transfer speed come from latenc of the pcivmebu
bridg the linux system show the fastest context
switch time howev the schedul of the standard
linux kernel chang process prioriti dynam it
worsen context switch time at high cpu load we did
not choos the standard linux becaus of it lack of fix
prioriti control that is essenti need for our purpos
becaus of the improv of the cpu perform
on the ia32 system we are abl to obtain a good enough
perform on solari wholli final we decid on
two kind of cpu board xycom xvme658 and
advanet advme8001 with a fanless configur
recent mani vendor provid realtim extens of
linux that can control process prioriti we will test
linux with realtim extens in the futur
refer
1 r tanaka et al control system of the spring8
storag ring icalepcs95 chicago usa 1995
p201
2 wwwlynuxworkscom
3 sun microsystem inc scalabl realtim
comput in the solari oper environ a
technic white paper februari 2000
4 r p kar and k portor rhealston a realtim
benchmark propos dr dobb journal of
softwar tool volum 14 number 2 1989 p 14
5 t masuda et al develop of devic driver on
realtim unix for the spring8 storag ring
control system icalepcs95 chicago usa
1995 p584
6 hewlettpackard compani driver write in the
hprt environ
7 tundra semiconductor corp univers ii user
manual spring 1998
8 wwwhpcom hprt specif
